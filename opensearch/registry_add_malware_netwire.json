{
  "type": "monitor",
  "name": "SIGMA - Potential NetWire RAT Activity - Registry",
  "description": "Detects registry keys related to NetWire RAT",
  "enabled": true,
  "schedule": {
    "period": {
      "interval": 10,
      "unit": "MINUTES"
    }
  },
  "inputs": [
    {
      "search": {
        "indices": [
          "logs-*-*",
          "beats-*"
        ],
        "query": {
          "size": 1,
          "query": {
            "bool": {
              "must": [
                {
                  "query_string": {
                    "query": "winlog.channel:Microsoft\\-Windows\\-Sysmon\\/Operational AND (event.code:12 AND (winlog.event_data.EventType:CreateKey AND registry.path:*\\\\software\\\\NetWire*))",
                    "analyze_wildcard": true
                  }
                }
              ]
            }
          }
        }
      }
    }
  ],
  "tags": [
    "attack-defense-evasion",
    "attack-t1112"
  ],
  "triggers": [
    {
      "name": "generated-trigger",
      "severity": 2,
      "condition": {
        "script": {
          "source": "ctx.results[0].hits.total.value > 0",
          "lang": "painless"
        }
      },
      "actions": []
    }
  ],
  "sigma_meta_data": {
    "rule_id": "1d218616-71b0-4c40-855b-9dbe75510f7f",
    "threat": []
  },
  "references": [
    "https://www.fortinet.com/blog/threat-research/new-netwire-rat-variant-spread-by-phishing",
    "https://resources.infosecinstitute.com/topic/netwire-malware-what-it-is-how-it-works-and-how-to-prevent-it-malware-spotlight/",
    "https://unit42.paloaltonetworks.com/guloader-installing-netwire-rat/",
    "https://blogs.blackberry.com/en/2021/09/threat-thursday-netwire-rat-is-coming-down-the-line",
    "https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/"
  ]
}