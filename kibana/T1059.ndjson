{
  "name": "SIGMA - T1059 - Malicious Command Execution via Python",
  "consumer": "siem",
  "enabled": true,
  "throttle": null,
  "schedule": {
    "interval": "5m"
  },
  "params": {
    "author": [
    "Meo"
    ],
    "description": "Detects malicious use of Python to execute commands.",
    "ruleId": "a96d2a90-9341-11ed-b1eb-0242ac120003",
    "falsePositives": ['Python usage by developers or system administrators'],
    "from": "now-5m",
    "immutable": false,
    "license": "DRL",
    "outputIndex": "",
    "meta": {
      "from": "1m"
    },
    "maxSignals": 100,
    "riskScore": (
        self.severity_risk_mapping[rule.level.name]
        if rule.level is not None
        else 21
    ),
    "riskScoreMapping": [],
    "severity": (
        str(rule.level.name).lower() if rule.level is not None else "low"
    ),
    "severityMapping": [],
    "threat": list(self.finalize_output_threat_model(rule.tags)),
    "to": "now",
    "references": [],
    "version": 1,
    "exceptionsList": [],
    "relatedIntegrations": [],
    "requiredFields": [],
    "setup": "",
    "type": "query",
    "language": "lucene",
    "index": [
      "apm-*-transaction*",
      "auditbeat-*",
      "endgame-*",
      "filebeat-*",
      "logs-*",
      "packetbeat-*",
      "traces-apm*",
      "winlogbeat-*",
      "-*elastic-cloud-logs-*"
],
    "query": "process.command_line:(*python\ \-c* OR *import\ requests* OR *os.system*)",
    "filters": []
  },
  "rule_type_id": "siem.queryRule",
  "tags": [
    "attack-execution",
  "attack-t1059"
  ],
  "notify_when": "onActiveAlert",
  "actions": []
}
